kind: 'ResourceDefinition'
metadata:
  name: 'HttpRouteDefinition'
  resourceKind: 'Route'
controllers:
  - runtime: 'node@>=20 <23'
    entrypoint: './nodejs/index.ts'
  - runtime: 'bun@>=1.1'
    entrypoint: './nodejs/index.ts'
schema:
  type: 'object'
  properties:
    metadata:
      type: 'object'
      properties:
        name:
          type: 'string'
        path:
          type: 'string'
        method:
          type: 'string'
          enum: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS']
      required: ['name', 'path', 'method']
    handler:
      type: 'string'
      description: 'URN to handler resource'
    request:
      type: 'object'
      properties:
        query:
          type: 'object'
        body:
          type: 'object'
        headers:
          type: 'object'
    middleware:
      type: 'array'
      items:
        type: 'string'
    response:
      type: 'object'
      properties:
        status:
          type: 'integer'
        headers:
          type: 'object'
        body:
          oneOf:
            - type: 'string'
            - type: 'object'
        schema:
          type: 'object'
          description: 'Response schema definition'
          properties:
            status:
              type: 'integer'
            headers:
              type: 'object'
            body:
              type: 'object'
        mapping:
          type: 'object'
          description: 'Response mapping expressions'
          properties:
            status:
              type: 'string'
            headers:
              type: 'object'
              additionalProperties:
                type: 'string'
            body:
              type: 'string'
  required: ['metadata', 'handler']
