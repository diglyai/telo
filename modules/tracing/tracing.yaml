kind: 'ResourceDefinition'
metadata:
  name: 'TracingProviderDefinition'
  resourceKind: 'Provider'
  module: 'Tracing'
controllers:
  - runtime: 'node@>=20 <23'
    entrypoint: './nodejs/index.ts'
  - runtime: 'bun@>=1.1'
    entrypoint: './nodejs/index.ts'
schema:
  type: 'object'
  properties:
    metadata:
      type: 'object'
      properties:
        name:
          type: 'string'
      required: ['name']
    exporters:
      type: 'array'
      description: 'List of exporter resource references (e.g., "Tracing.FileExporter.myExporter")'
      items:
        type: 'string'
    events:
      type: 'array'
      description: 'Event patterns to trace. Use "*" for all events, "Runtime.*" for all Runtime events, etc.'
      items:
        type: 'string'
      default: ['*']
    filters:
      type: 'object'
      description: 'Optional filtering configuration'
      properties:
        minLevel:
          type: 'string'
          enum: ['debug', 'info', 'error']
          default: 'debug'
    buffer:
      type: 'object'
      description: 'Event buffer configuration for retry logic'
      properties:
        maxSize:
          type: 'integer'
          description: 'Maximum number of events to buffer'
          default: 1000
          minimum: 1
        retryAttempts:
          type: 'integer'
          description: 'Number of retry attempts for failed exports'
          default: 3
          minimum: 0
        retryDelay:
          type: 'integer'
          description: 'Delay in milliseconds between retry attempts'
          default: 1000
          minimum: 0
  required: ['metadata', 'exporters']
